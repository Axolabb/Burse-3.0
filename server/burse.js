const EVENT_CATEGORIES = [
  "Криптовалюты",
  "Фондовый рынок",
  "Макроэкономика",
  "Технологии",
  "Геополитика",
  "Природные катастрофы/Здоровье",
  "Корпоративные новости",
];

const POSITIVE_EVENT_TEMPLATES = [
  // Криптовалюты
  {
    name: ["Ралли {Coin}", "Рост {Coin}", "Памп {Coin}", "{Coin} взлетел"],
    text: [
      "{Coin} вырос на {percent}% после одобрения {ETFType} ETF.",
      "Институциональные инвесторы вложили ${amount} млрд в {Coin}.",
      "{Coin} интегрирован в платежную систему {Service}.",
      "Успешное обновление {Coin} сети улучшило производительность на {featureGain}%.",
    ],

    categories: ["Криптовалюты"],
    xRange: [1.8, 2.5],
  },
  {
    name: ["Новый ETF", "Одобрение ETF", "ETF запускают"],
    text: [
      "SEC одобрила спотовый {Coin} ETF, открывая двери для крупных инвесторов.",
      "BlackRock запускает новый {Coin} ETF с $ {amount} млрд под управлением.",
    ],
    categories: ["Криптовалюты"],
    xRange: [2.0, 2.3],
  },
  // Фондовый рынок
  {
    name: [
      "Сильный отчет {Company}",
      "Прибыль {Company} растет",
      "Акции {Company} взлетели",
    ],
    text: [
      "{Company} опубликовала квартальный отчет, превзошедший ожидания аналитиков на {percent}%, акции резко выросли.",
      "{Company} объявила о новом прорывном продукте, вызывая ажиотаж на рынке.",
      "Квартальные результаты {Company} поразили рынок, превысив прогнозы на целых {percent}%, что привело к резкому скачку акций.",
      "Благодаря исключительному отчету, который превзошел ожидания на {percent}%, {Company} продемонстрировала уверенный рост, а ее акции устремились вверх.",
      "Прибыль {Company} взлетела на {percent}% выше прогнозов, что стало толчком к значительному росту стоимости акций.",
    ],
    categories: ["Фондовый рынок", "Корпоративные новости"],
    xRange: [1.5, 2.2],
  },
  {
    name: ["Рост S&P 500", "Индекс вырос", "Рынок на подъеме"],
    text: [
      "Индекс S&P 500 достиг исторического максимума на фоне сильных экономических данных.",
      "Мировой фондовый рынок переживает ралли после снижения инфляции.",
      "Рыночные индикаторы показывают позитивную динамику, отражая укрепление настроений инвесторов.",
      "Последние данные указывают на значительный рост ключевых показателей на фондовом рынке.",
      "Финансовые рынки демонстрируют уверенный подъем, реагируя на благоприятные экономические сигналы.",
      "Наблюдается выраженное движение вверх по основным индексам, что говорит об общем оживлении рынка.",
    ],
    categories: ["Фондовый рынок", "Макроэкономика"],
    xRange: [1.7, 2.0],
  },
  // Макроэкономика
  {
    name: [
      "Снижение инфляции",
      "Центробанк снизил ставку",
      "Экономический бум",
    ],
    text: [
      "Инфляция снизилась до {percent}% в стране {country}, что позитивно сказалось на рынках.",
      "Центральный банк страны {country} неожиданно снизил ключевую ставку, стимулируя экономику.",
      "В стране {country} наблюдается существенное улучшение экономических показателей, что отражается в текущих данных.",
      "Рыночные аналитики отмечают положительные изменения в экономике страны {country}, способствующие росту и стабильности.",
      "Последние экономические данные по стране {country} указывают на благоприятную динамику, вызывая оптимизм у инвесторов.",
      "Позитивные сдвиги в экономике страны {country} создают условия для дальнейшего развития и стимулирования активности.",
    ],
    categories: ["Макроэкономика"],
    xRange: [1.6, 2.1],
  },
  // Технологии
  {
    name: ["Прорыв в ИИ", "Новый чип {Company}", "Революция ИИ"],
    text: [
      "{Company} представила революционный чип для ИИ, который ускорит обучение моделей на {percent}%",
      "Прорыв в квантовых вычислениях открывает новые возможности для блокчейна.",
      "Компания {Company} объявила о значительном технологическом достижении, которое обещает преобразовать индустрию.",
      "Последние инновации в сфере высоких технологий открывают беспрецедентные возможности и стимулируют прогресс.",
      "Рынок замер в ожидании после публикации новостей о прорывной разработке, способной изменить правила игры.",
      "Новейшее достижение в области передовых вычислений обещает значительное ускорение и повышение эффективности.",
    ],
    categories: ["Технологии"],
    xRange: [1.9, 2.4],
  },
  // Геополитика
  {
    name: [
      "Мирное соглашение",
      "Снижение напряженности",
      "Торговое соглашение",
    ],
    text: [
      "Мирные переговоры между странами {Country1} и {Country2} привели к снижению геополитической напряженности.",
      "Подписано новое торговое соглашение, способствующее росту мирового ВВП.",
      "Переговоры между странами {Country1} и {Country2} принесли значительные результаты, снижая геополитическую напряженность в регионе {Region}.",
      "Новое соглашение, заключенное между странами {Country1} и {Country2}, открывает пути для стабильности и способствует экономическому росту на {percent}% в ближайшие годы.",
      "Подписано важное соглашение, которое, как ожидается, улучшит отношения между странами {Country1} и {Country2} и принесет выгоды для мирового ВВП на сумму до {amount} миллиардов долларов.",
      "Рынки отреагировали позитивно на новости о снижении напряженности в регионе {Region}, что обещает улучшение торговых связей между ключевыми игроками.",
    ],
    categories: ["Геополитика"],
    xRange: [1.5, 2.0],
  },
];

const NEGATIVE_EVENT_TEMPLATES = [
  // Криптовалюты
  {
    name: ["Падение {Coin}", "Обвал {Coin}", "{Coin} рухнул"],
    text: [
      "{Coin} упал на {percent}% после заявления SEC о новом регулировании.",
      "Крупная криптобиржа {ExchangeName} объявила о хакерской атаке на ${amount} млн.",
      "Правительство страны {country} ввело полный запрет на торговлю {Coin}.",
      "Стоимость {Coin} резко снизилась на {percent}% на фоне усиления регуляторного давления в стране {country}.",
      "После тревожных новостей о безопасности, связанных с {ExchangeName}, {Coin} демонстрирует значительное падение.",
      "Рынок {Coin} переживает обвал после того, как появились сообщения о крупных убытках в размере ${amount} миллионов на одной из ведущих платформ.",
      "Правительственные меры в стране {country} привели к резкому падению {Coin}, вызвав волнения среди инвесторов.",
      "Криптовалютный рынок, в частности {Coin}, столкнулся с серьезной коррекцией на {percent}% из-за неопределенности регулирования.",
      "Сообщения о масштабной кибератаке, затронувшей {ExchangeName}, негативно сказались на стоимости {Coin}.",
    ],
    categories: ["Криптовалюты"],
    xRange: [1.9, 2.8],
  },
  {
    name: ["Скандал с {Coin}", "Баг в {Coin}", "Взлом {Coin}"],
    text: [
      "Разработчики {Coin} обнаружили критический баг в смарт-контракте, средства под угрозой.",
      "Крупный скандал, связанный с основателями {Coin}, подорвал доверие.",
      "Сообщения о критической уязвимости в коде {Coin} вызвали панику среди держателей, поставив под угрозу {amount} миллионов {Coin}.",
      "После громкого скандала, связанного с внутренней работой {Company} и ее {Coin}, доверие к активу упало на {percent}%",
      "Обнаруженный баг в системе {Coin} привел к потере значительных средств на сумму {amount} {Coin}, вызвав опасения по поводу безопасности.",
      "Рынок {Coin} переживает потрясение после новостей о крупном инциденте, затронувшем {Service} и приведшем к утечке данных.",
      "Основатели {Coin} оказались в центре внимания из-за скандала, который может повлечь за собой серьезные регуляторные последствия в стране {country}.",
      "Хакерская атака на платформу, использующую {Coin}, привела к потерям на {amount} {Coin} и снижению курса на {percent}%.",
    ],
    categories: ["Криптовалюты"],
    xRange: [2.0, 2.7],
  },
  // Фондовый рынок
  {
    name: [
      "Убытки {Company}",
      "Акции {Company} обвалились",
      "Скандал в {Company}",
    ],
    text: [
      "{Company} отчиталась о неожиданных убытках в {amount} млрд долларов, акции рухнули на {percent}%.",
      "Против {Company} подан многомиллионный иск, вызывая падение капитализации.",
      "{Company} объявила о массовых увольнениях - {layoffCount} человек.",
      "{Company} столкнулась с серьезными финансовыми трудностями, объявив об убытках в размере {amount} млрд долларов, что вызвало падение акций на {percent}%.",
      "Капитализация {Company} резко сократилась на {percent}% после того, как стало известно о многомиллионном иске, поданном против компании.",
      "Неприятные новости сотрясают {Company}: объявлены массовые увольнения {layoffCount} сотрудников, что негативно сказалось на котировках акций.",
      "Рынки отреагировали падением акций {Company} на {percent}% после того, как компанию обвинили в неправомерных действиях и нарушении законодательства в стране {country}.",
      "Серьезные проблемы в {Company}, связанные с операционной деятельностью, привели к убыткам в {amount} млрд долларов и обвалу акций.",
    ],
    categories: ["Фондовый рынок", "Корпоративные новости"],
    xRange: [1.7, 2.5],
  },
  {
    name: ["Обвал S&P 500", "Падение индекса", "Медвежий рынок"],
    text: [
      "Индекс S&P 500 упал на {percent}% из-за опасений о рецессии.",
      "Мировой фондовый рынок вошел в фазу медвежьего рынка.",
      "Основные фондовые индексы, включая S&P 500, упали на {percent}% на фоне растущих опасений по поводу глобальной рецессии.",
      "Мировой фондовый рынок официально вошел в фазу медвежьего рынка, что сигнализирует о затяжном спаде и снижении капитализации на {amount} миллиардов.",
      "Негативные макроэкономические данные из страны {country} спровоцировали резкое падение S&P 500 на {percent}% и усилили пессимизм инвесторов.",
      "Индекс S&P 500 демонстрирует значительное падение, отражая общее ухудшение настроений на рынке и опасения за будущее экономики.",
      "После длительного периода роста, рынок акций столкнулся с серьезной коррекцией, в результате чего мировые индексы упали.",
    ],
    categories: ["Фондовый рынок", "Макроэкономика"],
    xRange: [2.0, 2.4],
  },
  // Макроэкономика
  {
    name: ["Рост инфляции", "Повышение ставки", "Экономический спад"],
    text: [
      "Инфляция подскочила до {percent}% в стране {country}, вынуждая Центробанк ужесточать политику.",
      "Центральный банк страны {country} неожиданно повысил ключевую ставку, замедляя рост экономики.",
      "Экономика страны {country} столкнулась с серьезными вызовами: инфляция подскочила до {percent}%, вынуждая центральный банк принимать решительные меры.",
      "На фоне ухудшения экономических показателей, Центральный банк страны {country} неожиданно повысил ключевую ставку, что может замедлить экономический рост и привести к снижению ВВП на {percent}%.",
      "Мировые рынки обеспокоены: прогнозы указывают на возможный экономический спад в регионе {Region}, где инфляция достигла критических {percent}%",
      "Аналитики предупреждают о надвигающемся спаде в стране {country}, так как меры по борьбе с инфляцией могут привести к сокращению {amount} тысяч рабочих мест.",
      "Последние данные по инфляции в стране {country} вызывают тревогу, поскольку ее рост на {percent}% может спровоцировать замедление экономики и снижение потребительской активности.",
    ],
    categories: ["Макроэкономика"],
    xRange: [1.8, 2.3],
  },
  // Технологии
  {
    name: ["Регулирование ИИ", "Замедление ИИ", "Баги в {TechCompany}"],
    text: [
      "Новое жесткое регулирование ИИ в стране {country} замедлит инновации.",
      "Обнаружен серьезный баг в популярной операционной системе от {TechCompany}, угрожающий миллионам устройств.",
      "Новое жесткое регулирование в сфере ИИ, введенное в стране {country}, угрожает инновациям и может замедлить развитие отрасли на {percent}%.",
      "{TechCompany} столкнулась с серьезными проблемами после обнаружения критического бага в одном из ее ключевых продуктов, затронувшего миллионы устройств по всему миру.",
      "Опасения по поводу замедления темпов развития ИИ усиливаются после появления строгих законодательных инициатив в регионе {Region}, которые могут повлиять на инвестиции в размере {amount} миллиардов долларов.",
      "Проблемы с безопасностью в программном обеспечении от {TechCompany} вызвали значительное недовольство пользователей и привели к потере доверия на {percent}%",
      "Эксперты прогнозируют замедление инноваций в области ИИ из-за ужесточения контроля со стороны правительств, особенно в стране {country}.",
      "Серьезные технические сбои и баги в продуктах {TechCompany} ставят под угрозу стабильность работы систем и требуют немедленного вмешательства.",
    ],
    categories: ["Технологии"],
    xRange: [1.5, 2.0],
  },
  // Геополитика
  {
    name: [
      "Эскалация конфликта",
      "Санкции против страны {country}",
      "Торговая война",
    ],
    text: [
      "Эскалация военного конфликта между странами {Country1} и {Country2} вызвала рост цен на нефть и панику на рынках.",
      "Новые санкции против страны {country} угрожают глобальной торговле.",
      "Нарастание напряженности между странами {Country1} и {Country2} привело к эскалации конфликта в регионе {Region}, вызвав значительный рост цен на нефть и панику на мировых рынках.",
      "Введение новых масштабных санкций против страны {country} угрожает стабильности глобальной торговли и может привести к убыткам в размере {amount} миллиардов долларов.",
      "Торговые разногласия между странами {Country1} и {Country2} переросли в полномасштабную торговую войну, что негативно сказывается на ВВП обеих стран на {percent}%.",
      "Обострение геополитической ситуации в регионе {Region} из-за конфликта между странами {Country1} и {Country2} создает риски для мировой экономики и ведет к неопределенности.",
      "Международное сообщество обеспокоено новыми ограничительными мерами против страны {country}, которые могут привести к нарушению цепочек поставок и снижению глобального товарооборота.",
    ],
    categories: ["Геополитика"],
    xRange: [2.1, 2.8],
  },
  // Природные катастрофы/Здоровье
  {
    name: ["Катастрофа {Region}", "Вспышка вируса", "Стихийное бедствие"],
    text: [
      "Крупное землетрясение в регионе {Region} нанесло огромный экономический ущерб.",
      "Вспышка нового, быстро распространяющегося вируса угрожает глобальной пандемией.",
      "Крупное стихийное бедствие в регионе {Region} нанесло колоссальный экономический ущерб, оцениваемый в {amount} миллиардов долларов, и привело к массовым разрушениям.",
      "Тревожные сообщения о вспышке нового, быстро распространяющегося вируса в стране {country} вызывают опасения глобальной пандемии и угрожают здоровью населения.",
      "Мощное землетрясение магнитудой в {percent} баллов в регионе {Region} привело к трагическим последствиям и серьезным разрушениям инфраструктуры.",
      "Эксперты предупреждают о риске стремительного распространения нового вируса, что может привести к закрытию границ и серьезным экономическим потерям в {amount} миллионов.",
      "Последствия стихийного бедствия в регионе {Region} оказались разрушительными, нарушив жизнь миллионов людей и вызвав кризис в сельском хозяйстве.",
    ],
    categories: ["Природные катастрофы/Здоровье"],
    xRange: [2.2, 2.9],
  },
];

const COINS = [
  "Bitcoin",
  "Ethereum",
  "Solana",
  "XRP",
  "Cardano",
  "Dogecoin",
  "Litecoin",
  "Polkadot",
  "Avalanche",
  "Polygon",
  "Chainlink",
  "Stellar",
  "VeChain",
  "Filecoin",
  "Algorand",
  "Cosmos",
  "Monero",
  "Tezos",
  "EOS",
  "Zcash",
  "Dash",
  "Neo",
  "IOTA",
  "Kusama",
];

const ETF_TYPES = [
  "спотовый",
  "фьючерсный",
  "деривативный",
  "индексный",
  "товарный",
  "валютный",
  "обратный",
  "рычаговый",
  "секторный",
];

const COMPANIES = [
  "Apple",
  "Microsoft",
  "Amazon",
  "Tesla",
  "Meta",
  "Google",
  "Nvidia",
  "Samsung",
  "Oracle",
  "Adobe",
  "Netflix",
  "Uber",
  "Airbnb",
  "Salesforce",
  "Intel",
  "AMD",
  "Sony",
  "Panasonic",
  "HP",
  "Dell",
  "Cisco",
  "Qualcomm",
  "IBM",
  "Twitter",
];

const COUNTRIES = [
  "США",
  "Китай",
  "Еврозона",
  "Япония",
  "Великобритания",
  "Германия",
  "Индия",
  "Бразилия",
  "Россия",
  "Канада",
  "Австралия",
  "Южная Корея",
  "Мексика",
  "Индонезия",
  "Турция",
  "Саудовская Аравия",
  "Швейцария",
  "Сингапур",
  "ЮАР",
  "Аргентина",
  "Нигерия",
  "ОАЭ",
  "Таиланд",
  "Израиль",
];

const EXCHANGES = [
  "Binance",
  "Coinbase",
  "Kraken",
  "Bybit",
  "OKX",
  "Huobi",
  "KuCoin",
  "Bitfinex",
  "Gemini",
  "FTX",
  "Bitstamp",
  "Bithumb",
  "Upbit",
  "Deribit",
  "Gate.io",
];

const SERVICES = [
  "PayPal",
  "Visa",
  "Mastercard",
  "Stripe",
  "Revolut",
  "Wise",
  "Square",
  "Payoneer",
  "Skrill",
  "Venmo",
  "AliPay",
  "WeChat Pay",
  "Apple Pay",
  "Google Pay",
  "Amazon Pay",
];

const REGIONS = [
  "Азия",
  "Северная Америка",
  "Европа",
  "Южная Америка",
  "Ближний Восток",
  "Африка",
  "Океания",
  "Центральная Америка",
  "Карибский бассейн",
  "Восточная Европа",
  "Западная Европа",
  "Северная Европа",
  "Южная Азия",
  "Юго-Восточная Азия",
];

const TECH_COMPANIES = [
  "Microsoft",
  "Google",
  "Apple",
  "IBM",
  "Intel",
  "AMD",
  "Dell",
  "HP",
  "Cisco",
  "Oracle",
  "Qualcomm",
  "Nvidia",
  "Samsung",
  "TSMC",
  "ASML",
  "Broadcom",
  "Micron",
  "Ericsson",
];

function getRandomInt(min, max) {
  min = Math.ceil(min);
  max = Math.floor(max);
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

function getRandomFloat(min, max) {
  return Math.random() * (max - min) + min;
}

function getRandomElement(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}

let globalEventIdCounter = 0; // Для уникального ID

function generateSingleEvent(chance = 0.5) {
  globalEventIdCounter++;
  const isPositive = Math.random() > chance;
  const templatePool = isPositive
    ? POSITIVE_EVENT_TEMPLATES
    : NEGATIVE_EVENT_TEMPLATES;
  const template = getRandomElement(templatePool);

  let name = getRandomElement(template.name);
  let text = getRandomElement(template.text);
  let x = getRandomFloat(template.xRange[0], template.xRange[1]).toFixed(2);

  // Подставляем переменные в name и text
  const replacements = {
    "{Coin}": getRandomElement(COINS),
    "{percent}": getRandomInt(5, 65), // Для процентов роста/падения
    "{ETFType}": getRandomElement(ETF_TYPES),
    "{amount}": getRandomInt(1, 800), // Для миллиардов/миллионов
    "{Service}": getRandomElement(SERVICES),
    "{featureGain}": getRandomInt(10, 50),
    "{Company}": getRandomElement(COMPANIES),
    "{country}": getRandomElement(COUNTRIES),
    "{ExchangeName}": getRandomElement(EXCHANGES),
    "{layoffCount}": getRandomInt(1000, 50000).toLocaleString("ru-RU"), // Тысячи уволенных
    "{Country1}": getRandomElement(COUNTRIES),
    "{Country2}": getRandomElement(COUNTRIES),
    "{Region}": getRandomElement(REGIONS),
    "{TechCompany}": getRandomElement(TECH_COMPANIES),
  };

  for (const key in replacements) {
    const value = replacements[key];
    name = name.replace(key, value);
    text = text.replace(key, value);
  }

  // Убедимся, что Country1 и Country2 не одинаковые, если они используются вместе
  if (
    name.includes("{Country1}") &&
    name.includes("{Country2}") &&
    replacements["{Country1}"] === replacements["{Country2}"]
  ) {
    replacements["{Country2}"] = getRandomElement(
      COUNTRIES.filter((c) => c !== replacements["{Country1}"])
    );
    name = name.replace("{Country2}", replacements["{Country2}"]);
    text = text.replace("{Country2}", replacements["{Country2}"]);
  }
  if (
    text.includes("{Country1}") &&
    text.includes("{Country2}") &&
    replacements["{Country1}"] === replacements["{Country2}"]
  ) {
    replacements["{Country2}"] = getRandomElement(
      COUNTRIES.filter((c) => c !== replacements["{Country1}"])
    );
    name = name.replace("{Country2}", replacements["{Country2}"]);
    text = text.replace("{Country2}", replacements["{Country2}"]);
  }

  return {
    id: `event_${String(globalEventIdCounter).padStart(6, "0")}`,
    name: name,
    text: text,
    x: parseFloat(x),
    vector: isPositive ? 1 : -1,
    time: Math.round(x * 4),
  };
}

let price = 1;
let priceBefore = 1
let x = 0;
let cycle = 0;
let cycleTime = 2000;  
function lessAttentionTact(array, cycleEnd) {
  let less = ((array.x / array.time) * array.vector) / 10  
  let lessAttent = setInterval(() => { 
    if (cycle <= cycleEnd) { 
      x -= less;
    } else {
      clearInterval(lessAttent)
    }
  }, cycleTime);
}
let action_chanse = 0.9;
let salty = 0;
setInterval(() => {
  priceBefore = price
  let NegativeActionChance = Math.log10(price) / 4.5 ;
  if (Math.random() > action_chanse) {
    let array = generateSingleEvent(NegativeActionChance);
    let boost = Math.min(1 / price, 30);
    array.x = array.x + boost;
    x = x + (array.x * array.vector) / 10;
    x = parseFloat(x.toFixed(3));
    price = price + price * x + 0.00001 < 0 ? 0 : price + price * x + 0.00001;
    action_chanse = 0.9;
    console.log(`🆔 ID события: ${array.id}`);
    console.log(`📛 Название: ${array.name}`);
    console.log(`📝 Описание: ${array.text}`);
    console.log(`💥 Влияние (x): ${array.x * 10}`);
    console.log(`🚀 Буст: ${boost * 10}`);
    console.log(
      `🔀 Вектор: ${array.vector === 1 ? "Положительный" : "Отрицательный"}`
    );
    console.log(`⏳ Время действия: ${array.time} тактов`);
    console.log("==========================================================\n");
    lessAttentionTact(array, array.time + cycle);
  } else {
    action_chanse -= 0.05;
    price = price + price * x + 0.00001 < 0 ? 0 : price + price * x + 0.00001;
    console.log("📊 Информация о текущем такте:");
    console.log(`🔁 Такт: ${cycle}`);
    console.log(`💲 Курс: ${price.toFixed(5)}$`);
    console.log(`📈 Коэффициент влияния: ${(x * 100).toFixed(2)}%`);
    console.log(
      `⚠️ Шанс негативного события: ${(NegativeActionChance * 100).toFixed(6)}%`
    );
    console.log(`🎯 Шанс события: ${((1 - action_chanse) * 100).toFixed(2)}%`);
    console.log(`🧂 Соль: ${salty * 100}%`);
    console.log("==========================================================\n");
  }
  let saltVector = getRandomFloat(0, 1) > 0.5 ? 1 : -1;
  x, (salty += 0.001 * saltVector);
  price = parseFloat(price.toFixed(5));
  x = parseFloat(x.toFixed(3));


  let color = "";
  let costTOBN = 0;
  let bottom = 0;
  

  if (price >= priceBefore) {
    color = "green";
    costTOBN = price - priceBefore;
    bottom = price - costTOBN;
  } else {
    color = "red";
    costTOBN = priceBefore - price;
    bottom = price;
  }
  const angleDeg = (Math.atan(costTOBN*25 / 35) * 180) / Math.PI

  fetch("http://localhost:3000/api/users/burse", {
    method: "POST",
    body: JSON.stringify({
      color: color,
      costTOB: costTOBN,
      bottom: bottom,
      actual: price,
      actual1: price,
      actualGlobal: priceBefore,
      angle: angleDeg,
      diagonal: Math.sqrt(Math.pow(costTOBN*25, 2) + 1225),
    }),
  }).catch(() => console.log("Введите 'npm run dev'"));
  cycle++;
}, cycleTime);

let actualData = null;
await fetch("http://localhost:3000/api/users/burseGet")
  .then((response) => {
    if (!response.ok) {
      throw new Error(response.status);
    }
    return response.json();
  })
  .then((data) => {
    if (data.length > 0) {
      actualData = data[data.length - 1].actualGlobal;
    } else {
      actualData = 1;
    }
  });
let actualGlobal = actualData;
let actual1 = 1;

// setInterval(() => {
//   let actual = 1;

  

//   actualGlobal = actual;
//   actual1 = actual / 25;
//   ; // ищем градус для диагонали
// }, 2000);
